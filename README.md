# Windows-Windows-Cleaner-
# Windows 清理工具

## 概述

Windows 清理工具是一款专为 Windows 操作系统设计的实用程序，旨在帮助用户轻松清理系统中的临时文件、缓存、无用数据等，以释放磁盘空间并提升系统性能。

## 功能特性

- **系统临时文件清理**：包括 Prefetch、LogFiles、缩略图等系统临时文件的清理。
- **浏览器缓存清理**：支持 Chrome、Edge 和 Firefox 浏览器的缓存清理。
- **微信缓存清理**：清理微信应用程序的缓存数据。
- **QQ缓存清理**：清理 QQ 应用程序的缓存数据。
- **Windows 之前的安装文件清理**：包括 Windows.old、Windows.BT 和 Windows.WS 文件夹的清理。
- **休眠文件清理**：通过命令行工具关闭休眠功能，删除休眠文件。
- **回收站清理**：清空系统回收站。
- **自定义路径清理**：允许用户添加自定义路径进行清理。
- **设置管理**：用户可以配置需要清理的项目。
- **软件管理**：提供软件管理的入口（需配合相应的软件管理工具）。

## 安装与运行

### 前提条件

- 操作系统：Windows 7 及以上版本。
- 管理员权限：部分清理功能需要管理员权限，程序会自动请求提升权限。

### 运行方式

1. **直接运行**：
   - 下载并解压程序压缩包。
   - 双击运行 `WindowsCleaner.exe`（或相应的可执行文件）。

2. **通过命令行运行**：
   - 打开命令提示符（CMD）或 PowerShell。
   - 导航到程序所在目录。
   - 运行 `WindowsCleaner.exe`。

### 请求管理员权限

程序在启动时会自动检测是否具有管理员权限，如果没有，将自动请求提升权限。请在弹出的 UAC（用户账户控制）对话框中点击“是”以允许程序获取必要的权限。

## 使用指南

### 主界面

启动程序后，主界面将显示软件名称、版本信息和开发者信息。主界面上有一个“开始清理”按钮，点击该按钮即可开始清理过程。

### 设置

通过菜单栏中的“设置”选项，您可以配置需要清理的项目：

1. **打开设置**：
   - 在主界面，点击顶部菜单栏的“设置”。

2. **选择清理项目**：
   - 在设置窗口中，您可以看到多个清理选项，如“系统临时文件”、“浏览器缓存”等。
   - 通过勾选相应的复选框，选择您希望清理的项目。

3. **自定义路径管理**：
   - 如果您选择了“自定义路径”，可以点击旁边的“管理”按钮，添加或删除自定义的清理路径。

4. **应用设置**：
   - 配置完成后，点击“应用”按钮保存设置。

### 软件管理

通过菜单栏中的“软件管理”选项，您可以打开软件管理工具（需配合相应的软件管理工具）：

1. **打开软件管理**：
   - 在主界面，点击顶部菜单栏的“软件管理”。

2. **使用软件管理工具**：
   - 如果相应的软件管理工具（例如 `SoftwareManager.exe`）存在于程序目录中，程序将尝试启动它。

### 清理过程

1. **开始清理**：
   - 点击主界面的“开始清理”按钮，程序将开始清理选定的项目。

2. **清理窗口**：
   - 清理过程中会弹出一个“清理中...”的窗口，显示清理进度和状态信息。

3. **完成提示**：
   - 清理完成后，会弹出一个消息框，显示清理的结果，包括处理的项目数量和成功删除的项目数量。

## 技术细节

### 管理员权限

程序使用 `ctypes` 库请求管理员权限，以确保能够执行需要高权限的操作，如删除系统文件和关闭休眠功能。

### 配置保存

程序的配置（如用户选择的清理项目、自定义路径等）保存在 `%APPDATA%\Windows清理工具\userdata\settings.json` 文件中，确保配置在程序重启后依然有效。

### 清理操作

程序通过调用操作系统 API 和执行文件系统操作来清理指定的文件和文件夹。例如，使用 `SHQueryRecycleBinW` 和 `SHEmptyRecycleBinW` API 清空回收站，使用 `os.remove` 和 `shutil.rmtree` 删除文件和文件夹。

### 多线程

清理操作在单独的线程中执行，以避免阻塞主界面，保证用户界面的响应性。

## 注意事项

- **数据备份**：在进行清理操作前，建议备份重要数据，以防误删。
- **系统文件**：部分清理项目涉及系统文件，请确保了解清理内容，避免影响系统稳定性。
- **权限问题**：某些清理操作需要管理员权限，确保以管理员身份运行程序。
- **自定义路径**：添加自定义路径时，请确保路径正确，避免误删重要文件。

## 常见问题

### Q1: 程序无法启动或提示权限不足？

**A1**: 请确保以管理员身份运行程序。程序启动时会自动请求提升权限，您需要在弹出的 UAC 对话框中点击“是”。

### Q2: 清理后某些文件仍然存在？

**A2**: 某些文件可能被系统或其他程序占用，导致无法删除。请确保相关程序已关闭，或手动删除这些文件。

### Q3: 如何恢复被清理的数据？

**A3**: 一旦数据被清理，通常无法恢复。请在清理前确认不再需要这些数据，或提前备份重要文件。

### Q4: 自定义路径无法添加或删除？

**A4**: 确保您有相应的文件系统权限，并且路径格式正确。如果问题依旧，尝试重新启动程序。

## 支持与反馈

如果您在使用过程中遇到问题或有改进建议，欢迎通过以下方式联系开发者：

- **GitHub 项目**：https://github.com/Liuhaoyu99/Windows-Windows-Cleaner-
- **电子邮件**：请在 GitHub 项目页面查找开发者的联系方式。

## 许可证

本项目采用 LICENSE（请根据实际情况填写许可证类型）。

## 更新日志

### 版本 2.0

- 新增软件管理功能，通过菜单栏“软件管理”入口启动。
- 优化设置界面，增加程序信息和 GitHub 链接。
- 改进自定义路径管理，支持添加和删除自定义清理路径。
- 修复若干已知问题，提升程序稳定性和用户体验。

---

**开发者**：刘浩宇  
**版本**：2.0  
**最后更新**：2025 年 8 月 21 日

---

*感谢您使用 Windows 清理工具，希望它能帮助您更好地管理和维护您的 Windows 系统！*
